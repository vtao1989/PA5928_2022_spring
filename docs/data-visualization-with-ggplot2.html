<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Data Visualization with ggplot2 | PA 5928 Data Management &amp; Visualization with R (Spring 2022)</title>
  <meta name="description" content="This is the website for couse PA 5928 in the University of Minnesota" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Data Visualization with ggplot2 | PA 5928 Data Management &amp; Visualization with R (Spring 2022)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the website for couse PA 5928 in the University of Minnesota" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Data Visualization with ggplot2 | PA 5928 Data Management &amp; Visualization with R (Spring 2022)" />
  
  <meta name="twitter:description" content="This is the website for couse PA 5928 in the University of Minnesota" />
  

<meta name="author" content="Tao Tao (University of Minnesota)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization-with-base-functions.html"/>
<link rel="next" href="statistics-in-r.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PA5928 R course</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Course Syllabus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i><b>1.1</b> Course description</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-prerequisites"><i class="fa fa-check"></i><b>1.2</b> Course prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#logistics"><i class="fa fa-check"></i><b>1.3</b> Logistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-learning-outcomes"><i class="fa fa-check"></i><b>1.4</b> Course learning outcomes</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#readings"><i class="fa fa-check"></i><b>1.5</b> Readings</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#weekly-assignment-and-final-project"><i class="fa fa-check"></i><b>1.6</b> Weekly assignment and final project</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#course-schedule"><i class="fa fa-check"></i><b>1.7</b> Course schedule</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#homework-and-projects-collaboration-and-submission-policy"><i class="fa fa-check"></i><b>1.8</b> Homework and projects collaboration and submission policy</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#univeristy-policies"><i class="fa fa-check"></i><b>1.9</b> Univeristy policies</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#safe-campus-covid-19-response"><i class="fa fa-check"></i><b>1.9.1</b> Safe Campus COVID-19 Response</a></li>
<li class="chapter" data-level="1.9.2" data-path="index.html"><a href="index.html#student-conduct-code"><i class="fa fa-check"></i><b>1.9.2</b> Student Conduct Code</a></li>
<li class="chapter" data-level="1.9.3" data-path="index.html"><a href="index.html#scholastic-dishonesty"><i class="fa fa-check"></i><b>1.9.3</b> Scholastic Dishonesty</a></li>
<li class="chapter" data-level="1.9.4" data-path="index.html"><a href="index.html#sexual-harassment-sexual-assault-stalking-and-relationship-violence"><i class="fa fa-check"></i><b>1.9.4</b> Sexual harassment, sexual assault, stalking and relationship violence</a></li>
<li class="chapter" data-level="1.9.5" data-path="index.html"><a href="index.html#equity-diversity-equal-opportunity-and-affirmative-action"><i class="fa fa-check"></i><b>1.9.5</b> Equity, Diversity, Equal Opportunity, and Affirmative Action</a></li>
<li class="chapter" data-level="1.9.6" data-path="index.html"><a href="index.html#disability-accommodations"><i class="fa fa-check"></i><b>1.9.6</b> Disability Accommodations</a></li>
<li class="chapter" data-level="1.9.7" data-path="index.html"><a href="index.html#mental-health-and-stress-management"><i class="fa fa-check"></i><b>1.9.7</b> Mental Health and Stress Management</a></li>
<li class="chapter" data-level="1.9.8" data-path="index.html"><a href="index.html#tennessen-warning-notice-pursuant-to-mn-department-of-administrations-data-practices"><i class="fa fa-check"></i><b>1.9.8</b> Tennessen Warning Notice Pursuant to MN Department of Administration’s Data Practices</a></li>
<li class="chapter" data-level="1.9.9" data-path="index.html"><a href="index.html#other-university-policies"><i class="fa fa-check"></i><b>1.9.9</b> Other university policies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2</b> What is RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#install-r-rstudio"><i class="fa fa-check"></i><b>2.3</b> Install R + RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#user-interface-of-rstudio"><i class="fa fa-check"></i><b>2.4</b> User interface of RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#create-and-save-r-file"><i class="fa fa-check"></i><b>2.5</b> Create and save R file</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#print-hello-world"><i class="fa fa-check"></i><b>2.6</b> Print Hello, world</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#install-and-use-r-packages"><i class="fa fa-check"></i><b>2.7</b> Install and use R Packages</a></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#make-notes"><i class="fa fa-check"></i><b>2.8</b> Make notes</a></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html#tips"><i class="fa fa-check"></i><b>2.9</b> Tips</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>3</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#why-r-and-why-not-r"><i class="fa fa-check"></i><b>3.1</b> Why R and why not R?</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variable-name"><i class="fa fa-check"></i><b>3.2</b> Variable name</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variable-types"><i class="fa fa-check"></i><b>3.3</b> Variable types</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#operations"><i class="fa fa-check"></i><b>3.4</b> Operations</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#assignment-operations"><i class="fa fa-check"></i><b>3.4.1</b> Assignment operations</a></li>
<li class="chapter" data-level="3.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#arithmetic-operations"><i class="fa fa-check"></i><b>3.4.2</b> Arithmetic operations</a></li>
<li class="chapter" data-level="3.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#relational-operations"><i class="fa fa-check"></i><b>3.4.3</b> Relational operations</a></li>
<li class="chapter" data-level="3.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#logical-operations"><i class="fa fa-check"></i><b>3.4.4</b> Logical operations</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures"><i class="fa fa-check"></i><b>3.5</b> Data structures</a></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#conditional-statement-if"><i class="fa fa-check"></i><b>3.6</b> Conditional statement (if)</a></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#loops"><i class="fa fa-check"></i><b>3.7</b> Loops</a></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>3.8</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation with Base Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#import-and-save-datasets"><i class="fa fa-check"></i><b>4.1</b> Import and save datasets</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#import-data-from-commonly-used-file-types"><i class="fa fa-check"></i><b>4.1.1</b> Import data from commonly-used file types</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#save-file"><i class="fa fa-check"></i><b>4.1.2</b> Save file</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#file-location"><i class="fa fa-check"></i><b>4.1.3</b> File location</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#view-data"><i class="fa fa-check"></i><b>4.2</b> View data</a></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#data-selection"><i class="fa fa-check"></i><b>4.3</b> Data selection</a></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#conditional-selection"><i class="fa fa-check"></i><b>4.4</b> Conditional selection</a></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#deal-with-missing-values"><i class="fa fa-check"></i><b>4.5</b> Deal with missing values</a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#subset"><i class="fa fa-check"></i><b>4.6</b> Subset</a></li>
<li class="chapter" data-level="4.7" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#merge-two-datasets"><i class="fa fa-check"></i><b>4.7</b> Merge two datasets</a></li>
<li class="chapter" data-level="4.8" data-path="data-manipulation-with-base-functions.html"><a href="data-manipulation-with-base-functions.html#column-operation"><i class="fa fa-check"></i><b>4.8</b> Column operation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation with dplyr</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#select"><i class="fa fa-check"></i><b>5.1</b> select()</a></li>
<li class="chapter" data-level="5.2" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#filter"><i class="fa fa-check"></i><b>5.2</b> filter()</a></li>
<li class="chapter" data-level="5.3" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>5.3</b> arrange()</a></li>
<li class="chapter" data-level="5.4" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#mutate"><i class="fa fa-check"></i><b>5.4</b> mutate()</a></li>
<li class="chapter" data-level="5.5" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#group_by-and-summarise"><i class="fa fa-check"></i><b>5.5</b> group_by() and summarise()</a></li>
<li class="chapter" data-level="5.6" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#join"><i class="fa fa-check"></i><b>5.6</b> join()</a></li>
<li class="chapter" data-level="5.7" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#pivot_wider-and-pivot_longer-in-tidyr"><i class="fa fa-check"></i><b>5.7</b> pivot_wider() and pivot_longer() in tidyr</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html"><i class="fa fa-check"></i><b>6</b> Data Visualization with Base Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html#scatter-plot"><i class="fa fa-check"></i><b>6.1</b> Scatter plot</a></li>
<li class="chapter" data-level="6.2" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html#line-plot"><i class="fa fa-check"></i><b>6.2</b> Line plot</a></li>
<li class="chapter" data-level="6.3" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html#bar-plot"><i class="fa fa-check"></i><b>6.3</b> Bar plot</a></li>
<li class="chapter" data-level="6.4" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html#add-more-elements-in-the-plots"><i class="fa fa-check"></i><b>6.4</b> Add more elements in the plots</a></li>
<li class="chapter" data-level="6.5" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html#pie-chart"><i class="fa fa-check"></i><b>6.5</b> Pie chart</a></li>
<li class="chapter" data-level="6.6" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html#boxplot"><i class="fa fa-check"></i><b>6.6</b> Boxplot</a></li>
<li class="chapter" data-level="6.7" data-path="data-visualization-with-base-functions.html"><a href="data-visualization-with-base-functions.html#color-in-r"><i class="fa fa-check"></i><b>6.7</b> Color in R</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#grammar-of-graphics-gg"><i class="fa fa-check"></i><b>7.1</b> Grammar of Graphics (gg)</a></li>
<li class="chapter" data-level="7.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#data-aesthetics-and-geometries"><i class="fa fa-check"></i><b>7.2</b> Data, Aesthetics, and Geometries</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#scatter-plot-1"><i class="fa fa-check"></i><b>7.2.1</b> Scatter plot</a></li>
<li class="chapter" data-level="7.2.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#bar-plot-1"><i class="fa fa-check"></i><b>7.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="7.2.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#line-plot-1"><i class="fa fa-check"></i><b>7.2.3</b> Line plot</a></li>
<li class="chapter" data-level="7.2.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#boxplot-1"><i class="fa fa-check"></i><b>7.2.4</b> Boxplot</a></li>
<li class="chapter" data-level="7.2.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#pie-chart-1"><i class="fa fa-check"></i><b>7.2.5</b> Pie chart</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>7.3</b> Facets</a></li>
<li class="chapter" data-level="7.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#coordinates"><i class="fa fa-check"></i><b>7.4</b> Coordinates</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#zooming-in-and-out"><i class="fa fa-check"></i><b>7.4.1</b> Zooming in and out</a></li>
<li class="chapter" data-level="7.4.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#ratio"><i class="fa fa-check"></i><b>7.4.2</b> Ratio</a></li>
<li class="chapter" data-level="7.4.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#swaping-the-axes"><i class="fa fa-check"></i><b>7.4.3</b> Swaping the axes</a></li>
<li class="chapter" data-level="7.4.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#polar-coordinate-system"><i class="fa fa-check"></i><b>7.4.4</b> Polar coordinate system</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>7.5</b> Themes</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#add-labels"><i class="fa fa-check"></i><b>7.5.1</b> Add labels</a></li>
<li class="chapter" data-level="7.5.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#change-ticks"><i class="fa fa-check"></i><b>7.5.2</b> Change ticks</a></li>
<li class="chapter" data-level="7.5.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#theme-function"><i class="fa fa-check"></i><b>7.5.3</b> theme() function</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#save-plot"><i class="fa fa-check"></i><b>7.6</b> Save plot</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="statistics-in-r.html"><a href="statistics-in-r.html"><i class="fa fa-check"></i><b>8</b> Statistics in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="statistics-in-r.html"><a href="statistics-in-r.html#plotting-statistics"><i class="fa fa-check"></i><b>8.1</b> Plotting statistics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="statistics-in-r.html"><a href="statistics-in-r.html#fitting-the-general-trend-of-points"><i class="fa fa-check"></i><b>8.1.1</b> Fitting the general trend of points</a></li>
<li class="chapter" data-level="8.1.2" data-path="statistics-in-r.html"><a href="statistics-in-r.html#plotting-distribution"><i class="fa fa-check"></i><b>8.1.2</b> Plotting distribution</a></li>
<li class="chapter" data-level="8.1.3" data-path="statistics-in-r.html"><a href="statistics-in-r.html#density-plot-of-distribution"><i class="fa fa-check"></i><b>8.1.3</b> Density plot of distribution</a></li>
<li class="chapter" data-level="8.1.4" data-path="statistics-in-r.html"><a href="statistics-in-r.html#box-plot-of-distribution"><i class="fa fa-check"></i><b>8.1.4</b> Box plot of distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="statistics-in-r.html"><a href="statistics-in-r.html#annotation-of-statistics"><i class="fa fa-check"></i><b>8.2</b> Annotation of statistics</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="statistics-in-r.html"><a href="statistics-in-r.html#bar-plot-2"><i class="fa fa-check"></i><b>8.2.1</b> bar plot</a></li>
<li class="chapter" data-level="8.2.2" data-path="statistics-in-r.html"><a href="statistics-in-r.html#line-plot-2"><i class="fa fa-check"></i><b>8.2.2</b> line plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="statistics-in-r.html"><a href="statistics-in-r.html#simple-statistics"><i class="fa fa-check"></i><b>8.3</b> Simple statistics</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="statistics-in-r.html"><a href="statistics-in-r.html#mean-and-median"><i class="fa fa-check"></i><b>8.3.1</b> Mean and median</a></li>
<li class="chapter" data-level="8.3.2" data-path="statistics-in-r.html"><a href="statistics-in-r.html#minimum-and-maximum-value"><i class="fa fa-check"></i><b>8.3.2</b> Minimum and maximum value</a></li>
<li class="chapter" data-level="8.3.3" data-path="statistics-in-r.html"><a href="statistics-in-r.html#quartile"><i class="fa fa-check"></i><b>8.3.3</b> Quartile</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="statistics-in-r.html"><a href="statistics-in-r.html#linear-regression"><i class="fa fa-check"></i><b>8.4</b> Linear regression</a></li>
<li class="chapter" data-level="8.5" data-path="statistics-in-r.html"><a href="statistics-in-r.html#logistic-regression"><i class="fa fa-check"></i><b>8.5</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>9</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-1-race-and-personal-income-in-the-city-of-minneapolis-2010-2019"><i class="fa fa-check"></i><b>9.1</b> Case 1: Race and personal income in the city of Minneapolis (2010-2019)</a></li>
<li class="chapter" data-level="9.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-2-race-and-employment-rate-in-the-city-of-minneapolis-2010-2019"><i class="fa fa-check"></i><b>9.2</b> Case 2: Race and employment rate in the city of Minneapolis (2010-2019)</a></li>
<li class="chapter" data-level="9.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-3-population-density-and-election-result-in-the-us-2020"><i class="fa fa-check"></i><b>9.3</b> Case 3: Population density and election result in the US (2020)</a></li>
<li class="chapter" data-level="9.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#case-4-factors-that-influence-students-performance"><i class="fa fa-check"></i><b>9.4</b> Case 4: Factors that influence students’ performance</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i><b>10</b> Final Project</a>
<ul>
<li class="chapter" data-level="10.1" data-path="final-project.html"><a href="final-project.html#description"><i class="fa fa-check"></i><b>10.1</b> Description</a></li>
<li class="chapter" data-level="10.2" data-path="final-project.html"><a href="final-project.html#timeline"><i class="fa fa-check"></i><b>10.2</b> Timeline</a></li>
<li class="chapter" data-level="10.3" data-path="final-project.html"><a href="final-project.html#proposal-of-problem-statement"><i class="fa fa-check"></i><b>10.3</b> Proposal of problem statement</a></li>
<li class="chapter" data-level="10.4" data-path="final-project.html"><a href="final-project.html#potential-data-sources"><i class="fa fa-check"></i><b>10.4</b> Potential data sources</a></li>
<li class="chapter" data-level="10.5" data-path="final-project.html"><a href="final-project.html#final-submission"><i class="fa fa-check"></i><b>10.5</b> Final submission</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PA 5928 Data Management &amp; Visualization with R (Spring 2022)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization-with-ggplot2" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Data Visualization with ggplot2</h1>
<p>In this chapter, we will learn using <code>ggplot2</code> to carry out data visualization tasks. Before the lecture, please install the package first.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="data-visualization-with-ggplot2.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;ggplot2&#39;</span>) <span class="do">## you only need to run this code once</span></span></code></pre></div>
<div id="grammar-of-graphics-gg" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Grammar of Graphics (gg)</h2>
<p>We have grammar for languages. Similarly, we have grammar for graphics. That’s where <code>gg</code> of <code>ggplot2</code> comes from. <code>ggplot2</code> has seven grammatical elements listed in the table below <span class="citation">(<a href="references.html#ref-datacamp1" role="doc-biblioref">DataCamp 2019</a>)</span>.</p>
<table>
<thead>
<tr class="header">
<th>Element</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data</td>
<td>The dataset being plotted.</td>
</tr>
<tr class="even">
<td>Aesthetics</td>
<td>The scales onto which we map our data.</td>
</tr>
<tr class="odd">
<td>Geometries</td>
<td>The visual elements used for our data.</td>
</tr>
<tr class="even">
<td>Facets</td>
<td>Plotting small multiples (subplots).</td>
</tr>
<tr class="odd">
<td>Statistics</td>
<td>Representations of our data to aid understanding.</td>
</tr>
<tr class="even">
<td>Coordinates</td>
<td>The space on which the data will be plotted.</td>
</tr>
<tr class="odd">
<td>Themes</td>
<td>All non-data ink.</td>
</tr>
</tbody>
</table>
<p>Let’s take the codes below as an example to show how different elements work in <code>ggplot2</code>.</p>
<p>Firstly, we need to import the packages and the Minneapolis ACS dataset. We will use <code>dplyr</code> to wrangle the dataset.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="data-visualization-with-ggplot2.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb314-2"><a href="data-visualization-with-ggplot2.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb314-3"><a href="data-visualization-with-ggplot2.html#cb314-3" aria-hidden="true" tabindex="-1"></a>minneapolis <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;minneapolis.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="data-visualization-with-ggplot2.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis, <span class="do">## Data</span></span>
<span id="cb315-2"><a href="data-visualization-with-ggplot2.html#cb315-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> AGE, <span class="at">y =</span> INCTOT)) <span class="sc">+</span> <span class="do">## Aesthetics</span></span>
<span id="cb315-3"><a href="data-visualization-with-ggplot2.html#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="do">## Geometries</span></span>
<span id="cb315-4"><a href="data-visualization-with-ggplot2.html#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(YEAR)) <span class="sc">+</span> <span class="do">## Facets</span></span>
<span id="cb315-5"><a href="data-visualization-with-ggplot2.html#cb315-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="co"># Statistics</span></span>
<span id="cb315-6"><a href="data-visualization-with-ggplot2.html#cb315-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&#39;Age&#39;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb315-7"><a href="data-visualization-with-ggplot2.html#cb315-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&#39;Personal income (dollars)&#39;</span>) <span class="sc">+</span> <span class="co"># Coordinates</span></span>
<span id="cb315-8"><a href="data-visualization-with-ggplot2.html#cb315-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Age and personal income in Minneapolis (2010-2019)&#39;</span>) <span class="sc">+</span></span>
<span id="cb315-9"><a href="data-visualization-with-ggplot2.html#cb315-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co"># Themes</span></span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
<p>The figure shows the scatter plots of age and personal income in the city of Minneapolis from 2010 to 2019. In addition, the plot fits a nonlinear relationship (the blue line) between the age and personal income for each year.</p>
</div>
<div id="data-aesthetics-and-geometries" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Data, Aesthetics, and Geometries</h2>
<p>Generally, if you want to draw figures with <code>ggplot2</code>, you need at least three elements, which are data, aesthetics, and geometries. Data is the dataset we want to visualize. Aesthetic specifies how to map the variables to the scales in plots. Geometry indicates the plot type and related attributes. Take the example above again. We want to visualize the variables of <code>AGE</code> and <code>TOTINC</code> (aesthetic) of the dataset <code>minneapolis</code> (data, the Minneapolis ACS dataset) with a scatter plot (geometry). In summary,</p>
<p>Similar to <code>dplyr</code>, <code>ggplot2</code> also has its own style of coding. We start with the <code>ggplot()</code> function. <strong>Please pay attention that there is no <code>2</code> in the name of the function</strong>. In the function, we first indicate the name of the dataset (usually a data frame). Then we use <code>aes()</code> to indicate the scales we want to map our data. Here, we map <code>AGE</code> to x axis, and <code>TOTINC</code> to y axis. Then we use a plus sign <code>+</code> to connect it to other functions. We are going to draw a scatter plot, so we use <code>geom_point()</code>. We only use a 2017 subsample from the Minneapolis ACS dataset. Note that the observations with missing values have been removed during plotting (that’s why we have a warning message).</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="data-visualization-with-ggplot2.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="do">## select a subsample of those in 2017</span></span>
<span id="cb316-2"><a href="data-visualization-with-ggplot2.html#cb316-2" aria-hidden="true" tabindex="-1"></a>minneapolis_2017 <span class="ot">&lt;-</span> <span class="fu">filter</span>(minneapolis, YEAR <span class="sc">==</span> <span class="dv">2017</span>)</span>
<span id="cb316-3"><a href="data-visualization-with-ggplot2.html#cb316-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-4"><a href="data-visualization-with-ggplot2.html#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="do">## this example give us a simple example of ggplot2</span></span>
<span id="cb316-5"><a href="data-visualization-with-ggplot2.html#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="co"># Data</span></span>
<span id="cb316-6"><a href="data-visualization-with-ggplot2.html#cb316-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> AGE, <span class="at">y =</span> INCTOT)) <span class="sc">+</span> <span class="co"># Aesthetics</span></span>
<span id="cb316-7"><a href="data-visualization-with-ggplot2.html#cb316-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># Geometries</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>Based on this plot, we have a overall idea of the relationship between <code>AGE</code> and <code>TOTINC</code>. When age increases, people’s personal income increases. However, after a certain age, people’s personal income decreases as their age increases. (This relationship is just a type of correlation, not causality.)</p>
<p>In most cases, we will map variables to x axis and y axis. Therefore, we can replace the <code>aes(x = AGE, y = INCTOT)</code> to <code>aes(AGE, INCTOT)</code> to save some input (such as the codes below). We will stick to this style in the following lectures. Also, I recommend to put each function on a new line.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="data-visualization-with-ggplot2.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span></span>
<span id="cb318-2"><a href="data-visualization-with-ggplot2.html#cb318-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>We could add more scales as aesthetic elements in the plot. For example, we could use color to indicate the value of <code>EDUC</code> by adding <code>col = EDUC</code>. (<code>col</code>, <code>color</code>, and <code>colour</code> all work here.)</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="data-visualization-with-ggplot2.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT, <span class="at">col =</span> EDUC)) <span class="sc">+</span></span>
<span id="cb319-2"><a href="data-visualization-with-ggplot2.html#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
<p>Now we have more information in the result. While the respondent has a higher education level, s/he has a higher personal income.</p>
<p>Here, <code>EDUC</code> is a continuous variable, so <code>ggplot2</code> uses the darkness of color to indicate the value. If we use a categorical variable or a factor (e.g., binomial variable), <code>ggplot2</code> will use different colors to show different levels.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="data-visualization-with-ggplot2.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="do">## remove observations with missing employment status from the dataset</span></span>
<span id="cb321-2"><a href="data-visualization-with-ggplot2.html#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="do">## change EMPSTAT from numeric values to corresponding characteristic values</span></span>
<span id="cb321-3"><a href="data-visualization-with-ggplot2.html#cb321-3" aria-hidden="true" tabindex="-1"></a>minneapolis_emp <span class="ot">&lt;-</span> minneapolis_2017 <span class="sc">%&gt;%</span> </span>
<span id="cb321-4"><a href="data-visualization-with-ggplot2.html#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EMPSTAT <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb321-5"><a href="data-visualization-with-ggplot2.html#cb321-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb321-6"><a href="data-visualization-with-ggplot2.html#cb321-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMPSTAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb321-7"><a href="data-visualization-with-ggplot2.html#cb321-7" aria-hidden="true" tabindex="-1"></a>      EMPSTAT <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&#39;Employed&#39;</span>,</span>
<span id="cb321-8"><a href="data-visualization-with-ggplot2.html#cb321-8" aria-hidden="true" tabindex="-1"></a>      EMPSTAT <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">&#39;Unemployed&#39;</span>,</span>
<span id="cb321-9"><a href="data-visualization-with-ggplot2.html#cb321-9" aria-hidden="true" tabindex="-1"></a>      EMPSTAT <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">&#39;Not in labor force&#39;</span></span>
<span id="cb321-10"><a href="data-visualization-with-ggplot2.html#cb321-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb321-11"><a href="data-visualization-with-ggplot2.html#cb321-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb321-12"><a href="data-visualization-with-ggplot2.html#cb321-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-13"><a href="data-visualization-with-ggplot2.html#cb321-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_emp, <span class="fu">aes</span>(AGE, INCTOT, <span class="at">col =</span> EMPSTAT)) <span class="sc">+</span></span>
<span id="cb321-14"><a href="data-visualization-with-ggplot2.html#cb321-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<p><code>EMPSTAT</code> stands for the employment status (employed, not in labor force, unemployed). <code>ggplot2</code> usually treats variables with characteristic values as factor. <code>ggplot2</code> uses different colors to stand for different employment status. By reading the plot, we know that as age increases, more people are not in labor force. The personal income of employed people are higher than those not in labor force. (There are not many unemployed observations in this dataset, so it is hard to tell its pattern.)</p>
<p>Besides <code>color</code>, there are several other scales can be used in plots. Continuous variable and categorical variable will generate different results when being mapped to these scales. Usually, color and shape work well with categorical variables. Size works well for continuous variables. But it still depends on the dataset you are dealing with. The best practice is always trying it for yourself.</p>
<table>
<thead>
<tr class="header">
<th>Scales</th>
<th>Description</th>
<th>Continuous variable</th>
<th>Categorical variable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>x axis position</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td>y</td>
<td>y axis position</td>
<td>✓</td>
<td></td>
</tr>
<tr class="odd">
<td>size</td>
<td>Diameter of points, thickness of lines</td>
<td>✓</td>
<td></td>
</tr>
<tr class="even">
<td>alpha</td>
<td>Transparency</td>
<td>✓</td>
<td></td>
</tr>
<tr class="odd">
<td>color</td>
<td>Color of dots, outlines of other shapes</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td>fill</td>
<td>Fill color</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td>labels</td>
<td>Text on a plot or axes</td>
<td></td>
<td>✓</td>
</tr>
<tr class="even">
<td>shape</td>
<td>Shape of point</td>
<td></td>
<td>✓</td>
</tr>
<tr class="odd">
<td>linetype</td>
<td>Line dash pattern</td>
<td></td>
<td>✓</td>
</tr>
</tbody>
</table>
<p>If you want to set a scale to a fixed value, not a variable, you can do it in the geometry outside of <code>aes()</code>.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="data-visualization-with-ggplot2.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span></span>
<span id="cb322-2"><a href="data-visualization-with-ggplot2.html#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="data-visualization-with-ggplot2.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span></span>
<span id="cb324-2"><a href="data-visualization-with-ggplot2.html#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<p>Note that setting the value of alpha helps you recognize the density of the points in scatter plots. The plot above shows that the respondents are more distributed in the younger group.</p>
<p>Geometry has many different types. For examples, <code>geom_point()</code> for scatter plot, <code>geom_bar()</code> for bar plot, <code>geom_boxplot()</code> for box plot, <em>etc</em>. Most functions of geometries are self-explained, so you could understand their usages easily. We will talk about those commonly used geometries such as scatter plot, bar plot, line plot, <em>etc</em> in the following parts.</p>
<div id="scatter-plot-1" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Scatter plot</h3>
<p>We use <code>geom_point()</code> to plot scatter plot. In the example below, we map <code>AGE</code> to x axis, and <code>INCTOT</code> to y axis. We indicate the color by set <code>col = EDUC</code>. The darkness of each point is decided by its value of <code>EDUC</code> (when the value is larger, the color is lighter).</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="data-visualization-with-ggplot2.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT, <span class="at">col =</span> EDUC)) <span class="sc">+</span></span>
<span id="cb326-2"><a href="data-visualization-with-ggplot2.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
</div>
<div id="bar-plot-1" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Bar plot</h3>
<p>In the example below, we draw a bar plot to show the number of respondents in different racial groups. In <code>aes()</code>, we only indicate the variable <code>RACE</code> by setting <code>x = RACE</code>. R then will count the number of respondents for each racial groups. We, then, use <code>geom_bar()</code> to plot it.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="data-visualization-with-ggplot2.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="at">x =</span> RACE)) <span class="sc">+</span></span>
<span id="cb328-2"><a href="data-visualization-with-ggplot2.html#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p>In the following example, we count the number of respondents in each racial groups firstly. In the next step, we plot the bar plot by setting <code>stat = 'identity'</code> in <code>geom_bar()</code> to tell R to plot a bar plot based on the values directly (without counting).</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="data-visualization-with-ggplot2.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="do">## count the number of respondents based on RACE</span></span>
<span id="cb329-2"><a href="data-visualization-with-ggplot2.html#cb329-2" aria-hidden="true" tabindex="-1"></a>minneaplis_race <span class="ot">&lt;-</span> minneapolis_2017 <span class="sc">%&gt;%</span> </span>
<span id="cb329-3"><a href="data-visualization-with-ggplot2.html#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RACE) <span class="sc">%&gt;%</span> </span>
<span id="cb329-4"><a href="data-visualization-with-ggplot2.html#cb329-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb329-5"><a href="data-visualization-with-ggplot2.html#cb329-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-6"><a href="data-visualization-with-ggplot2.html#cb329-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneaplis_race, <span class="fu">aes</span>(RACE, count)) <span class="sc">+</span></span>
<span id="cb329-7"><a href="data-visualization-with-ggplot2.html#cb329-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="co"># you need to specify stat = &#39;identity&#39; to plot the value for each year</span></span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<p>Or you could use another geometry called <code>geom_col()</code> to do it.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="data-visualization-with-ggplot2.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneaplis_race, <span class="fu">aes</span>(RACE, count)) <span class="sc">+</span></span>
<span id="cb330-2"><a href="data-visualization-with-ggplot2.html#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="data-visualization-with-ggplot2.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="at">x =</span> RACE, <span class="at">fill =</span> <span class="fu">factor</span>(SEX))) <span class="sc">+</span></span>
<span id="cb331-2"><a href="data-visualization-with-ggplot2.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
</div>
<div id="line-plot-1" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Line plot</h3>
<p>In this example, we use <code>geom_line()</code> to draw a line plot.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="data-visualization-with-ggplot2.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate the average personal income for each year</span></span>
<span id="cb332-2"><a href="data-visualization-with-ggplot2.html#cb332-2" aria-hidden="true" tabindex="-1"></a>minneapolis_year <span class="ot">&lt;-</span> minneapolis <span class="sc">%&gt;%</span> </span>
<span id="cb332-3"><a href="data-visualization-with-ggplot2.html#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> </span>
<span id="cb332-4"><a href="data-visualization-with-ggplot2.html#cb332-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AvgInc =</span> <span class="fu">mean</span>(INCTOT, <span class="at">na.rm =</span> T))</span>
<span id="cb332-5"><a href="data-visualization-with-ggplot2.html#cb332-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-6"><a href="data-visualization-with-ggplot2.html#cb332-6" aria-hidden="true" tabindex="-1"></a><span class="do">## line plot of the trend of average personal income</span></span>
<span id="cb332-7"><a href="data-visualization-with-ggplot2.html#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_year, <span class="fu">aes</span>(YEAR, AvgInc)) <span class="sc">+</span></span>
<span id="cb332-8"><a href="data-visualization-with-ggplot2.html#cb332-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">&#39;Blue&#39;</span>) <span class="co"># indicate the color of the line by setting col = &#39;Blue&#39;</span></span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
<p>If we map a variable to color in this plot, we will have several lines with different lines indicating different levels in the variable.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="data-visualization-with-ggplot2.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate the average personal income for each racial group in each year</span></span>
<span id="cb333-2"><a href="data-visualization-with-ggplot2.html#cb333-2" aria-hidden="true" tabindex="-1"></a>minneapolis_year_race <span class="ot">&lt;-</span> minneapolis <span class="sc">%&gt;%</span> </span>
<span id="cb333-3"><a href="data-visualization-with-ggplot2.html#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, RACE) <span class="sc">%&gt;%</span> </span>
<span id="cb333-4"><a href="data-visualization-with-ggplot2.html#cb333-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AvgInc =</span> <span class="fu">mean</span>(INCTOT, <span class="at">na.rm =</span> T))</span>
<span id="cb333-5"><a href="data-visualization-with-ggplot2.html#cb333-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-6"><a href="data-visualization-with-ggplot2.html#cb333-6" aria-hidden="true" tabindex="-1"></a><span class="do">## line plot of the trend of average personal income</span></span>
<span id="cb333-7"><a href="data-visualization-with-ggplot2.html#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_year_race, <span class="fu">aes</span>(YEAR, AvgInc, <span class="at">col =</span> <span class="fu">factor</span>(RACE))) <span class="sc">+</span></span>
<span id="cb333-8"><a href="data-visualization-with-ggplot2.html#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() </span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
</div>
<div id="boxplot-1" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Boxplot</h3>
<p>In the example below, we draw a box plot for the personal income in each racial group. To do this, we map <code>RACE</code> to the x axis, and <code>INCTOT</code> to the y axis. We use <code>factor()</code> to transfer <code>RACE</code> to a factor (categorical variable).</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="data-visualization-with-ggplot2.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="fu">factor</span>(RACE), INCTOT)) <span class="sc">+</span> </span>
<span id="cb334-2"><a href="data-visualization-with-ggplot2.html#cb334-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
<p>One problem of box plots is that they cannot show the number of observations. For example, you do not have an idea how many points in each racial groups. We could use the geometry of jittering instead. Jittering randomly adds a little noise to the data points to avoid overlapping. The points in the plot below has been added some random noise in the direction of x axis.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="data-visualization-with-ggplot2.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="fu">factor</span>(RACE), INCTOT)) <span class="sc">+</span> </span>
<span id="cb336-2"><a href="data-visualization-with-ggplot2.html#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
<p>Another geometry is violin plot, which shows the density of the distribution.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="data-visualization-with-ggplot2.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="fu">factor</span>(RACE), INCTOT)) <span class="sc">+</span> </span>
<span id="cb338-2"><a href="data-visualization-with-ggplot2.html#cb338-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_ydensity).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="data-visualization-with-ggplot2.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="fu">factor</span>(RACE), INCTOT, <span class="at">col =</span> <span class="fu">factor</span>(SEX))) <span class="sc">+</span> </span>
<span id="cb340-2"><a href="data-visualization-with-ggplot2.html#cb340-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_ydensity).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
</div>
<div id="pie-chart-1" class="section level3" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Pie chart</h3>
<p>In <code>ggplot2</code>, it is not as intuitive as the base function <code>pie()</code> to draw a pie chart.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="data-visualization-with-ggplot2.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneaplis_race, <span class="fu">aes</span>(<span class="st">&#39;&#39;</span>, count, <span class="at">fill =</span> <span class="fu">factor</span>(RACE))) <span class="sc">+</span></span>
<span id="cb342-2"><a href="data-visualization-with-ggplot2.html#cb342-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="sc">+</span></span>
<span id="cb342-3"><a href="data-visualization-with-ggplot2.html#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&#39;y&#39;</span>) <span class="co"># transfer the coordinate system to the polar one</span></span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
<p>What<code>ggplot2</code> does here to draw a pie plot is to create a bar plot first.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="data-visualization-with-ggplot2.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneaplis_race, <span class="fu">aes</span>(<span class="st">&#39;&#39;</span>, count, <span class="at">fill =</span> <span class="fu">factor</span>(RACE))) <span class="sc">+</span></span>
<span id="cb343-2"><a href="data-visualization-with-ggplot2.html#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
<p>And then transfer the coordinate system to the polar one.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="data-visualization-with-ggplot2.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneaplis_race, <span class="fu">aes</span>(<span class="st">&#39;&#39;</span>, count, <span class="at">fill =</span> <span class="fu">factor</span>(RACE))) <span class="sc">+</span></span>
<span id="cb344-2"><a href="data-visualization-with-ggplot2.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="sc">+</span></span>
<span id="cb344-3"><a href="data-visualization-with-ggplot2.html#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
</div>
</div>
<div id="facets" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Facets</h2>
<p>If you want to split up your data by one or more variables and plot each subset in one figure, <code>facet</code> is the element you want to use.</p>
<p>In the following example, we draw a scatter plot for each racial group. In each plot, we map <code>AGE</code> to the x axis and <code>INCTOT</code> to y axis. The three plots are aligned in a row.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="data-visualization-with-ggplot2.html#cb345-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span><span class="co"># store the plot result in variable p</span></span>
<span id="cb345-2"><a href="data-visualization-with-ggplot2.html#cb345-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb345-3"><a href="data-visualization-with-ggplot2.html#cb345-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-4"><a href="data-visualization-with-ggplot2.html#cb345-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> RACE) <span class="co"># Facets, for each racial group</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<p>If we want to align the plots in a column, exchange the position of the variable in the function.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="data-visualization-with-ggplot2.html#cb347-1" aria-hidden="true" tabindex="-1"></a> p <span class="sc">+</span> <span class="fu">facet_grid</span>(RACE <span class="sc">~</span> .) <span class="co"># Facets, pay attention to the position of RACE and the dot sign</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p>We could put more variables to split the plots. In the following example, we put one more variable <code>SEX</code> in the <code>facet_grid()</code>.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="data-visualization-with-ggplot2.html#cb349-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_grid</span>(SEX <span class="sc">~</span> RACE) <span class="co"># add vs</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<p>We could use the <code>margins = T</code> to add more plots showing the aggregation of the plots in each column or row.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="data-visualization-with-ggplot2.html#cb351-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_grid</span>(SEX <span class="sc">~</span> RACE, <span class="at">margins =</span> T) <span class="co"># add aggregation plots for each row and column</span></span></code></pre></div>
<pre><code>## Warning: Removed 1816 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<p>We could use <code>labeller = label_both</code> to add more information in the label.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="data-visualization-with-ggplot2.html#cb353-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_grid</span>(SEX <span class="sc">~</span> RACE, <span class="at">labeller =</span> label_both) <span class="co"># add more info in the label</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
<p>With <code>facet_wrap()</code>, we can spread the subplots evenly in the screen space.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="data-visualization-with-ggplot2.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span></span>
<span id="cb355-2"><a href="data-visualization-with-ggplot2.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb355-3"><a href="data-visualization-with-ggplot2.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>EDUC)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p>Based on the plot, we have three observations. The first is the relationship between age and personal income. The second is that personal income grows as education level increases. The final one is that there are more respondents with higher education level in the survey than those with lower education level.</p>
</div>
<div id="coordinates" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Coordinates</h2>
<p>While there are many coordinate systems supported by <code>ggplot2</code>, the most commonly used is Cartesian coordinate system, which is the combination of x axis and y axis orthogonally.</p>
<div id="zooming-in-and-out" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Zooming in and out</h3>
<p>In the following example, we zoom in our plot to a specific area.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="data-visualization-with-ggplot2.html#cb357-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span></span>
<span id="cb357-2"><a href="data-visualization-with-ggplot2.html#cb357-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()</span>
<span id="cb357-3"><a href="data-visualization-with-ggplot2.html#cb357-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">100</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20000</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
</div>
<div id="ratio" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Ratio</h3>
<p>We could change the ratio of the length of a y unit relative to the length of a x unit (<span class="math inline">\(\frac{\text{y unit}}{\text{x unit}}\)</span>).</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="data-visualization-with-ggplot2.html#cb359-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, EDUC)) <span class="sc">+</span></span>
<span id="cb359-2"><a href="data-visualization-with-ggplot2.html#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb359-3"><a href="data-visualization-with-ggplot2.html#cb359-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="do">## 1 mean the units are same in x and y axis</span></span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="data-visualization-with-ggplot2.html#cb360-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
</div>
<div id="swaping-the-axes" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Swaping the axes</h3>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="data-visualization-with-ggplot2.html#cb361-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="data-visualization-with-ggplot2.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="fu">factor</span>(SEX), INCTOT)) <span class="sc">+</span> </span>
<span id="cb362-2"><a href="data-visualization-with-ggplot2.html#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb362-3"><a href="data-visualization-with-ggplot2.html#cb362-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="data-visualization-with-ggplot2.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="at">x =</span> RACE)) <span class="sc">+</span></span>
<span id="cb364-2"><a href="data-visualization-with-ggplot2.html#cb364-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb364-3"><a href="data-visualization-with-ggplot2.html#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
</div>
<div id="polar-coordinate-system" class="section level3" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Polar coordinate system</h3>
<p>We touched the polar coordinate system a little bit when drawing a pie chart.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="data-visualization-with-ggplot2.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&#39;&#39;</span>, <span class="at">fill =</span> <span class="fu">factor</span>(EDUC))) <span class="sc">+</span></span>
<span id="cb365-2"><a href="data-visualization-with-ggplot2.html#cb365-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb365-3"><a href="data-visualization-with-ggplot2.html#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
<p>We could do this in a different way.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="data-visualization-with-ggplot2.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(EDUC))) <span class="sc">+</span></span>
<span id="cb366-2"><a href="data-visualization-with-ggplot2.html#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&#39;Black&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;Grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb366-3"><a href="data-visualization-with-ggplot2.html#cb366-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
</div>
</div>
<div id="themes" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Themes</h2>
<p><code>ggplot2</code> is powerful in its flexibility of themes.</p>
<div id="add-labels" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Add labels</h3>
<p>Add labels with <code>labs()</code> function.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="data-visualization-with-ggplot2.html#cb367-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span></span>
<span id="cb367-2"><a href="data-visualization-with-ggplot2.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb367-3"><a href="data-visualization-with-ggplot2.html#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>)</span>
<span id="cb367-4"><a href="data-visualization-with-ggplot2.html#cb367-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Age and personal income in Minneapolis (2017)&#39;</span>, <span class="co"># title of the plot</span></span>
<span id="cb367-5"><a href="data-visualization-with-ggplot2.html#cb367-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&#39;Data source: American Community Survey&#39;</span>, <span class="co"># sub title</span></span>
<span id="cb367-6"><a href="data-visualization-with-ggplot2.html#cb367-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&#39;Age&#39;</span>, <span class="co"># x label</span></span>
<span id="cb367-7"><a href="data-visualization-with-ggplot2.html#cb367-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;Personal income (dollars)&#39;</span>) <span class="co"># y label</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
<p>Or use <code>ggtitle()</code>, <code>xlab()</code>, and <code>ylab()</code> instead.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="data-visualization-with-ggplot2.html#cb370-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&#39;Age and personal income in Minneapolis (2017)&#39;</span>) <span class="sc">+</span> <span class="co"># title</span></span>
<span id="cb370-2"><a href="data-visualization-with-ggplot2.html#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Age&#39;</span>) <span class="sc">+</span> <span class="co"># x label</span></span>
<span id="cb370-3"><a href="data-visualization-with-ggplot2.html#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Personal income (dollars)&#39;</span>) <span class="co"># y label</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>With value of <code>NULL</code> to remove labels.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="data-visualization-with-ggplot2.html#cb373-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb373-2"><a href="data-visualization-with-ggplot2.html#cb373-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="co"># x label</span></span>
<span id="cb373-3"><a href="data-visualization-with-ggplot2.html#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="co"># y label</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="change-ticks" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Change ticks</h3>
<p>Here is an example of changing the ticks for a discrete variable.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="data-visualization-with-ggplot2.html#cb376-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(<span class="fu">factor</span>(SEX), INCTOT))</span>
<span id="cb376-2"><a href="data-visualization-with-ggplot2.html#cb376-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb376-3"><a href="data-visualization-with-ggplot2.html#cb376-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Gender&quot;</span>, <span class="co"># name of the x axis</span></span>
<span id="cb376-4"><a href="data-visualization-with-ggplot2.html#cb376-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Male&#39;</span>, <span class="st">&#39;Female&#39;</span>)) <span class="co"># change 1 and 2 to Male and Female</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="data-visualization-with-ggplot2.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(minneapolis_year, <span class="fu">aes</span>(YEAR, AvgInc)) <span class="sc">+</span></span>
<span id="cb378-2"><a href="data-visualization-with-ggplot2.html#cb378-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">&#39;Blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb378-3"><a href="data-visualization-with-ggplot2.html#cb378-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>))  <span class="sc">+</span></span>
<span id="cb378-4"><a href="data-visualization-with-ggplot2.html#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30000</span>, <span class="dv">50000</span>, <span class="dv">2500</span>))<span class="do">## set the ticks</span></span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
</div>
<div id="theme-function" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> theme() function</h3>
<p><code>theme()</code> function could change the styles of all components of plots. Here are a few examples about it <span class="citation">(<a href="references.html#ref-ggplot1" role="doc-biblioref">ggplot2 2019</a>)</span>.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="data-visualization-with-ggplot2.html#cb379-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(minneapolis_2017, <span class="fu">aes</span>(AGE, INCTOT)) <span class="sc">+</span></span>
<span id="cb379-2"><a href="data-visualization-with-ggplot2.html#cb379-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb379-3"><a href="data-visualization-with-ggplot2.html#cb379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Age and personal income in Minneapolis (2017)&#39;</span>,</span>
<span id="cb379-4"><a href="data-visualization-with-ggplot2.html#cb379-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&#39;Data source: American Community Survey&#39;</span>,</span>
<span id="cb379-5"><a href="data-visualization-with-ggplot2.html#cb379-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&#39;Age&#39;</span>,</span>
<span id="cb379-6"><a href="data-visualization-with-ggplot2.html#cb379-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;Personal income (dollars)&#39;</span>)</span>
<span id="cb379-7"><a href="data-visualization-with-ggplot2.html#cb379-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-8"><a href="data-visualization-with-ggplot2.html#cb379-8" aria-hidden="true" tabindex="-1"></a>p <span class="co"># original plot</span></span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<p>We could use <code>plot.title</code> to change the style of a title in the plot. In the following example, we change the font size of the title by setting <code>element_text()</code> and making <code>size</code> to be twice larger as the default one.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="data-visualization-with-ggplot2.html#cb381-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<p>We could also use absolute value to indicate the size directly.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="data-visualization-with-ggplot2.html#cb383-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<p>We could change the background of the plot by setting the value of <code>plot.background</code> in the <code>theme()</code> function. For example, if we want to change the color, we could set <code>element_rect()</code> and <code>fill = 'red'</code>.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="data-visualization-with-ggplot2.html#cb385-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;red&#39;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
<p>More specifically, if we want to change the style of the panel, which is the inner part restricted by x and y axes, we could set the value of <code>panel.background</code>.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="data-visualization-with-ggplot2.html#cb387-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;green&#39;</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>
<p>We could set the line type of the panel’s border.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="data-visualization-with-ggplot2.html#cb389-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">fill =</span> <span class="cn">NA</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
<p>Change the attributes of the lines for the grid. <code>element_line()</code> stands for the attributes of the lines.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="data-visualization-with-ggplot2.html#cb391-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;black&#39;</span>),</span>
<span id="cb391-2"><a href="data-visualization-with-ggplot2.html#cb391-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-189-1.png" width="672" /></p>
<p>Use <code>element_blank()</code> to remove the themes of the target.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="data-visualization-with-ggplot2.html#cb393-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb393-2"><a href="data-visualization-with-ggplot2.html#cb393-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
<p>We could put the grid line on the top of our data by setting <code>panel.ontop = TRUE</code>.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="data-visualization-with-ggplot2.html#cb395-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb395-2"><a href="data-visualization-with-ggplot2.html#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb395-3"><a href="data-visualization-with-ggplot2.html#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;Blue&#39;</span>),</span>
<span id="cb395-4"><a href="data-visualization-with-ggplot2.html#cb395-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.ontop =</span> <span class="cn">TRUE</span></span>
<span id="cb395-5"><a href="data-visualization-with-ggplot2.html#cb395-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-191-1.png" width="672" /></p>
<p>Change the line style of the axis.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="data-visualization-with-ggplot2.html#cb397-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb397-2"><a href="data-visualization-with-ggplot2.html#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb397-3"><a href="data-visualization-with-ggplot2.html#cb397-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
<p>Change the text style of the axis.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="data-visualization-with-ggplot2.html#cb399-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb399-2"><a href="data-visualization-with-ggplot2.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&#39;Green&#39;</span>, <span class="at">size =</span> <span class="dv">15</span>)</span>
<span id="cb399-3"><a href="data-visualization-with-ggplot2.html#cb399-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-193-1.png" width="672" /></p>
<p>Change the attributes of the axis ticks.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="data-visualization-with-ggplot2.html#cb401-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb401-2"><a href="data-visualization-with-ggplot2.html#cb401-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>)</span>
<span id="cb401-3"><a href="data-visualization-with-ggplot2.html#cb401-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<p>And y label.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="data-visualization-with-ggplot2.html#cb403-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb403-2"><a href="data-visualization-with-ggplot2.html#cb403-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">angle =</span> <span class="dv">30</span>)</span>
<span id="cb403-3"><a href="data-visualization-with-ggplot2.html#cb403-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
<p>Now, let’s see what we could do for the legend.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="data-visualization-with-ggplot2.html#cb405-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(minneapolis_emp, <span class="fu">aes</span>(AGE, INCTOT, <span class="at">color =</span> <span class="fu">factor</span>(EMPSTAT))) <span class="sc">+</span></span>
<span id="cb405-2"><a href="data-visualization-with-ggplot2.html#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb405-3"><a href="data-visualization-with-ggplot2.html#cb405-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb405-4"><a href="data-visualization-with-ggplot2.html#cb405-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&#39;Age&#39;</span>,</span>
<span id="cb405-5"><a href="data-visualization-with-ggplot2.html#cb405-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&#39;Personal income (dollars)&#39;</span>,</span>
<span id="cb405-6"><a href="data-visualization-with-ggplot2.html#cb405-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&#39;Employment status&#39;</span></span>
<span id="cb405-7"><a href="data-visualization-with-ggplot2.html#cb405-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb405-8"><a href="data-visualization-with-ggplot2.html#cb405-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-9"><a href="data-visualization-with-ggplot2.html#cb405-9" aria-hidden="true" tabindex="-1"></a>p <span class="do">## original plot</span></span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
<p>Remove the legend by setting its position as <code>legend.position = 'none'</code>.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="data-visualization-with-ggplot2.html#cb406-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb406-2"><a href="data-visualization-with-ggplot2.html#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span></span>
<span id="cb406-3"><a href="data-visualization-with-ggplot2.html#cb406-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="data-visualization-with-ggplot2.html#cb407-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb407-2"><a href="data-visualization-with-ggplot2.html#cb407-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">&#39;top&#39;</span></span>
<span id="cb407-3"><a href="data-visualization-with-ggplot2.html#cb407-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<p>By setting <code>legend.justification</code> for the legend, we anchor point for positioning legend inside plot (“center” or two-element numeric vector) or the justification according to the plot area when positioned outside the plot</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="data-visualization-with-ggplot2.html#cb408-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb408-2"><a href="data-visualization-with-ggplot2.html#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.justification =</span> <span class="st">&#39;top&#39;</span></span>
<span id="cb408-3"><a href="data-visualization-with-ggplot2.html#cb408-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="data-visualization-with-ggplot2.html#cb409-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb409-2"><a href="data-visualization-with-ggplot2.html#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>),</span>
<span id="cb409-3"><a href="data-visualization-with-ggplot2.html#cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="st">&#39;right&#39;</span>, <span class="st">&#39;top&#39;</span>),</span>
<span id="cb409-4"><a href="data-visualization-with-ggplot2.html#cb409-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.box.just =</span> <span class="st">&#39;right&#39;</span></span>
<span id="cb409-5"><a href="data-visualization-with-ggplot2.html#cb409-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="data-visualization-with-ggplot2.html#cb410-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb410-2"><a href="data-visualization-with-ggplot2.html#cb410-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb410-3"><a href="data-visualization-with-ggplot2.html#cb410-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb410-4"><a href="data-visualization-with-ggplot2.html#cb410-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
<p>Set attributes for the key of the legend.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="data-visualization-with-ggplot2.html#cb411-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb411-2"><a href="data-visualization-with-ggplot2.html#cb411-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb411-3"><a href="data-visualization-with-ggplot2.html#cb411-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
<p>Set attributes for the text of the legend.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="data-visualization-with-ggplot2.html#cb412-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb412-2"><a href="data-visualization-with-ggplot2.html#cb412-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">face =</span> <span class="st">&#39;bold&#39;</span>)</span>
<span id="cb412-3"><a href="data-visualization-with-ggplot2.html#cb412-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
<p>If you do not like to customize the theme one element by one element. <code>ggplot2</code> also provides some function which give you a complete theme. For example, the <code>theme_bw()</code> we used at the start of this lecture. Note that complete theme can cover the setting of theme before it (not those after it).</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="data-visualization-with-ggplot2.html#cb413-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="data-visualization-with-ggplot2.html#cb414-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="data-visualization-with-ggplot2.html#cb415-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_dark</span>()</span></code></pre></div>
<p><img src="PA5928_2022_spring_files/figure-html/unnamed-chunk-206-1.png" width="672" /></p>
<p>Please check <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">here</a> for more complete theme.</p>
</div>
</div>
<div id="save-plot" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Save plot</h2>
<p>You can use <code>ggsave()</code> to save the current plot. You need to specify the name (including file extension such as <code>jpg</code>, <code>png</code>) of the plot in the function.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="data-visualization-with-ggplot2.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&#39;plot.jpg&#39;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization-with-base-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistics-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
